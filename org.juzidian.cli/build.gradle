def genDir = "$buildDir/generated"

def genResDir = "$genDir/resources"

def dictionaryDbPath = "$genResDir/juzidian-dictionary.db"

def cedictDataPath = "${project(':org.juzidian.core').projectDir}/cedict-data.txt"

dependencies {
	compile project(':org.juzidian.core')
	compile project(':org.juzidian.build.data')
	compile 'com.google.inject:guice:3.0:no_aop'
	compile 'org.xerial:sqlite-jdbc:3.7.2'
	compile 'com.j256.ormlite:ormlite-jdbc:4.42'
	runtime 'org.slf4j:slf4j-jdk14:1.6.1'
}

sourceSets {
	main {
		resources {
			srcDirs "$genResDir"
		}
	}
}

jar {
    manifest {
        attributes 'Main-Class': 'org.juzidian.cli.JuzidianCli'
    }
}

task generateResources {
	inputs.file file("$cedictDataPath")
	outputs.file file("$dictionaryDbPath")
	doLast {
		mkdir("$genResDir")
		javaexec {
			main = 	'org.juzidian.build.data.DictionaryDataBaseCreator'
			classpath = sourceSets.main.runtimeClasspath
			args cedictDataPath, dictionaryDbPath
		}
	}
}

compileJava.dependsOn generateResources
